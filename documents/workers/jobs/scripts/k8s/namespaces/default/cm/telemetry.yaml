apiVersion: v1
kind: ConfigMap
metadata:
  name: telemetry
  namespace: default
data:
  yul_dc.toml: |
    [rules]
    #######  DC YUL02  #######

    #[[rules.yul02_nvidia_total_hashrate_cfx]]
    #dialect = "clickhouse:stats"
    #query = '''select sum(hashrate)/1000000000 from (select avg(hashrate1h) as hashrate from miner_card_algorithm_hashrate_new where site_key=unhex('007acb68f8a4ffdfc7741c413e4bfc94ff4d7d85b1') and time>subtractMinutes(now(), 10) and algorithm=25  group by worker,pci_id)'''
    #warning_threshold = 52000.0
    #critical_threshold = 51000.0
    #service = "yul02"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "yul02"
    #disable_auto_resolve = false

    [[rules.yul02_amd_total_hashrate_eth]]
    dialect = "clickhouse:stats"
    query = '''select sum(hashrate)/1000000000 from (select avg(hashrate1h) as hashrate from miner_card_algorithm_hashrate_new where site_key=unhex('05524764c0f3f80bbebd051eb39bcb960d4a4117a5') and time>subtractMinutes(now(), 10)  group by worker,pci_id)'''
    warning_threshold = 88000.0
    critical_threshold = 80000.0
    service = "yul02"
    check_interval = 120
    counter_threshold = 0.006
    dc = "yul02"
    disable_auto_resolve = false

    [[rules.yul02_nvidia_total_hashrate_ethash_from_pool]]
    dialect = "athena:rawdata"
    query = '''select sum(hashrate)/1000000 from (select avg(hash_rate) as hashrate from pbtb_mining_pool_worker where normalized_uri like 'https://www.sparkpool.com/v1/worker/list?miner=0x96F8628103339E56d38CF4DF9042b5673Cb31f12&pool=SPARK_POOL_CN&currency=ETH' and to_unixtime(now()) - _pbtb_ts < 3600 and parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day group by name )'''
    warning_threshold = 9000.0
    critical_threshold = 8800.0
    service = "yul02"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul02"
    disable_auto_resolve = false

    [[rules.yul02_amd_total_hashrate_ethash_from_pool]]
    dialect = "athena:rawdata"
    query = '''select sum(hashrate)/1000000 from (select avg(hash_rate) as hashrate from pbtb_mining_pool_worker where normalized_uri like 'https://www.sparkpool.com/v1/worker/list?miner=0xDf78CF4B51367328483f53b5Dda9101D181ee452&pool=SPARK_POOL_CN&currency=ETH' and to_unixtime(now()) - _pbtb_ts < 3600 and parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day group by name )'''
    warning_threshold = 82000.0
    critical_threshold = 75000.0
    service = "yul02"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul02"
    disable_auto_resolve = true

    [[rules.yul02_amd_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('05524764c0f3f80bbebd051eb39bcb960d4a4117a5') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 412.0
    critical_threshold = 410.0
    service = "yul02"
    check_interval = 120
    counter_threshold = 0.006
    dc = "yul02"
    disable_auto_resolve = false

    [[rules.yul02_nvidia_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('007acb68f8a4ffdfc7741c413e4bfc94ff4d7d85b1') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 444.0
    critical_threshold = 400.0
    service = "yul02"
    check_interval = 120
    counter_threshold = 0.006
    dc = "yul02"
    disable_auto_resolve = false

    [[rules.yul02_reward_estimation_eth]]
    dialect = "clickhouse:stats"
    query = '''select sum(pool_income)/sum(estimation_reward) from site_revenue_new  where date>=subtractDays(now(),7) and site_name='yul02' and coin='ETH' '''
    warning_threshold = 0.958
    critical_threshold = 0.955
    service = "yul02"
    check_interval = 3600
    counter_threshold = 0.0
    dc = "yul02"
    disable_auto_resolve = true

    #[[rules.yul02_nvidia_warning_total_livenode]]
    #dialect = "clickhouse:stats"
    #query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('007acb68f8a4ffdfc7741c413e4bfc94ff4d7d85b1') and time>subtractMinutes(now(), 10)'''
    #warning_threshold = 444.0
    #critical_threshold = 442.0
    #service = "yul02"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "yul02"
    #disable_auto_resolve = true

    [[rules.yul02_amd_total_livenode_from_pool]]
    dialect = "clickhouse:stats"
    query = '''select count (distinct worker) from miner_pool_stats where normalized_uri LIKE 'https://www.sparkpool.com/v1/worker/list?miner=0xDf78CF4B51367328483f53b5Dda9101D181ee452&pool=SPARK_POOL_CN&currency=ETH' and time>subtractMinutes(now(),60) and FROM_UNIXTIME(toInt64(last_share))>subtractMinutes(now(),60)'''
    warning_threshold = 430.0
    critical_threshold = 420.0
    service = "yul02"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul02"
    disable_auto_resolve = false

    [[rules.yul02_max_gpu_temperature]]
    dialect = "clickhouse:stats"
    query = '''select max(temperature) from miner_card_stats where site_key=unhex('007acb68f8a4ffdfc7741c413e4bfc94ff4d7d85b1') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 81.0
    critical_threshold = 85.0
    service = "yul02"
    check_interval = 120
    counter_threshold = 0.006
    dc = "yul02"
    disable_auto_resolve = true

    [[rules.yul02_amd_max_gpu_temperature]]
    dialect = "clickhouse:stats"
    query = '''select max(temperature) from miner_card_stats where site_key=unhex('05524764c0f3f80bbebd051eb39bcb960d4a4117a5') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 81.0
    critical_threshold = 85.0
    service = "yul02"
    check_interval = 120
    counter_threshold = 0.006
    dc = "yul02"
    disable_auto_resolve = true

    [[rules.yul02_amd_reward_estimation_eth]]
    dialect = "clickhouse:stats"
    query = '''select sum(pool_income)/sum(estimation_reward) from site_revenue  where date>=subtractDays(now(),7) and site_name='yul02_amd' and coin='ETH' '''
    warning_threshold = 0.958
    critical_threshold = 0.955
    service = "yul02"
    check_interval = 3600
    counter_threshold = 0.0
    dc = "yul02"
    disable_auto_resolve = true

    #[[rules.yul02_max_syslog_daily_quantity]]
    #dialect = "athena:rawdata"
    #query = '''SELECT count(_pbtb_uuid) AS count FROM pbtb_syslog WHERE dc='yul02' AND _pbtb_ts > to_unixtime(now()) - 86400 AND parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day '''
    #warning_threshold = 58320000.0
    #critical_threshold = 87480000.0
    #service = "ops"
    #check_interval = 600
    #counter_threshold = 0.0
    #dc = "yul02"
    #disable_auto_resolve = true

    ########  Pool huobi #######
    #[[rules.huobi_pool_hashrate]]
    #dialect = "clickhouse:stats"
    #query = '''select avg(hashrate) from huobi_pool_data where time>subtractMinutes(now(),10)'''
    #warning_threshold = 185.0
    #critical_threshold = 183.0
    #service = "urumqi"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "urumqi"
    #disable_auto_resolve = true

    #[[rules.huobi_pool_livenode]]
    #dialect = "clickhouse:stats"
    #query = '''select avg(online_worker) from huobi_pool_data where time>subtractMinutes(now(),10)'''
    #warning_threshold = 1090.0
    #critical_threshold = 1089.0
    #service = "urumqi"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "urumqi"
    #disable_auto_resolve = true

    #######  Pool User yul02  #######
    #[[rules.yul02_pool_2hour_livenode]]
    #dialect = "clickhouse:pool"
    #query = '''select count(distinct worker) from conflux_user_worker_hashrate_15m where username='yul02' and time>=subtractMinutes(now(),120) '''
    #warning_threshold = 400.0
    #critical_threshold = 370.0
    #service = "yul02"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "yul02"
    #disable_auto_resolve = true

    #[[rules.yul02_pool_total_hashrate]]
    #dialect = "clickhouse:pool"
    #query = '''select sum(hashrate)/30000000 from pool_overview where time>subtractMinutes(now(),33) and time<=subtractMinutes(now(),3)  and frontend='yul02' and status='ACCEPTED_SHARE' '''
    #warning_threshold = 52000.0
    #critical_threshold = 47000.0
    #service = "yul02"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "yul02"
    #disable_auto_resolve = true

    #######  Pool User urc01  #######
    #[[rules.urc01_pool_2hour_livenode]]
    #dialect = "clickhouse:pool"
    #query = '''select count(distinct worker) from conflux_user_worker_hashrate_15m where username='urc01' and time>=subtractMinutes(now(),120) '''
    #warning_threshold = 450.0
    #critical_threshold = 440.0
    #service = "urumqi"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "urumqi"
    #disable_auto_resolve = true

    #[[rules.urc01_pool_total_hashrate]]
    #dialect = "clickhouse:pool"
    #query = '''select sum(hashrate)/30000000 from pool_overview where time>subtractMinutes(now(),33) and time<=subtractMinutes(now(),3)  and frontend='ctu01' and status='ACCEPTED_SHARE' '''
    #warning_threshold = 10000.0
    #critical_threshold = 5000.0
    #service = "urumqi"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "urumqi"
    #disable_auto_resolve = true

    #######  DC Urumqi P104 #######

    [[rules.urumqi_p104_total_hashrate_eth]]
    dialect = "clickhouse:stats"
    query = '''select sum(hashrate)/1000000 from (select avg(hash_rate) as hashrate from miner_speed where site_key='18C6UKAprzSbR6R2FMFxpnak991cgjjuDb' and time>subtractMinutes(now(),20)  and algorithm=1 group by worker,pci_id)'''
    warning_threshold = 11000.0
    critical_threshold = 10000.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi"
    disable_auto_resolve = false

    [[rules.urumqi_p104_total_hashrate_ethash_from_pool]]
    dialect = "athena:rawdata"
    query = '''select sum(hashrate)/1000000 from (select avg(hash_rate) as hashrate from pbtb_mining_pool_worker where normalized_uri like 'https://www.sparkpool.com/v1/worker/list?miner=0x3ca1a99Abf377769e9d9A65cE3FAf19034Ca8d13&pool=SPARK_POOL_CN&currency=ETH' and to_unixtime(now()) - _pbtb_ts < 3600 and parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day group by name )'''
    warning_threshold = 3600.0
    critical_threshold = 3500.0
    service = "urumqi"
    check_interval = 600
    counter_threshold = 0.0
    dc = "urumqi"
    disable_auto_resolve = false

    [[rules.urumqi_p104_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('004ee205e0a0a6bdc3b08d2fc5e3d557908e55fd75') and time>subtractMinutes(now(), 20)'''
    warning_threshold = 117.0
    critical_threshold = 115.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi"
    disable_auto_resolve = false

    #[[rules.urumqi_p104_total_livenode_from_pool]]
    #dialect = "athena:rawdata"
    #query = '''select count(distinct(name)) as workers from pbtb_mining_pool_worker where normalized_uri like 'https://api.nanopool.org/v1/eth/user/0x3ca1a99Abf377769e9d9A65cE3FAf19034Ca8d13' and to_unixtime(now()) - _pbtb_ts < 3600 and to_unixtime(now()) - last_share < 3600 and parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    #warning_threshold = 148.0
    #critical_threshold = 146.0
    #service = "urumqi"
    #check_interval = 600
    #counter_threshold = 0.0
    #dc = "urumqi"
    #disable_auto_resolve = true

    # trigger when missing one node. and send to the PD dynamic servcie
    [[rules.urumqi_p104_warning_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('004ee205e0a0a6bdc3b08d2fc5e3d557908e55fd75') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 118.0
    critical_threshold = 117.0
    service = "urumqi_dynamic"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi"
    disable_auto_resolve = false

    [[rules.urumqi_p104_max_gpu_temperature]]
    dialect = "clickhouse:stats"
    query = '''select max(temperature) from miner_card_stats where site_key=unhex('004ee205e0a0a6bdc3b08d2fc5e3d557908e55fd75') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 79.0
    critical_threshold = 85.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi"
    disable_auto_resolve = false

    [[rules.urumqi_max_syslog_daily_quantity]]
    dialect = "athena:rawdata"
    query = '''SELECT count(_pbtb_uuid) AS count FROM pbtb_syslog WHERE dc='urumqi' AND _pbtb_ts > to_unixtime(now()) - 86400 AND parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day '''
    # livenodes * 86400
    warning_threshold = 89683200.0
    # warnning * 1.2
    critical_threshold = 107619840.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "urumqi"
    disable_auto_resolve = true

    #######  DC Urumqi P102 #######

    [[rules.urumqi_p102_total_hashrate_eth]]
    dialect = "clickhouse:stats"
    query = '''select sum(hashrate)/1000000 from (select avg(hash_rate) as hashrate from miner_speed where site_key='1K3xhxvZvKaj7EG4NAfw7rY65ghA4r1Qqr' and time>subtractMinutes(now(),20)  and algorithm=1 group by worker,pci_id)'''
    warning_threshold = 8000.0
    critical_threshold = 7000.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_p102"
    disable_auto_resolve = false

    [[rules.urumqi_p102_total_hashrate_ethash_from_pool]]
    dialect = "athena:rawdata"
    query = '''select sum(hashrate)/1000000 from (select avg(hash_rate) as hashrate from pbtb_mining_pool_worker where normalized_uri like 'https://www.sparkpool.com/v1/worker/list?miner=0x2991728c82587C3E86A3bA47F204F11aB875D22b&pool=SPARK_POOL_CN&currency=ETH' and to_unixtime(now()) - _pbtb_ts < 3600 and parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day group by name )'''
    warning_threshold = 1300.0
    critical_threshold = 1200.0
    service = "urumqi"
    check_interval = 600
    counter_threshold = 0.0
    dc = "urumqi_p102"
    disable_auto_resolve = true

    [[rules.urumqi_p102_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('00c60198e81cbba05916463195d69ad7d376e415e3') and time>subtractMinutes(now(), 15)'''
    warning_threshold = 89.0
    critical_threshold = 87.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_p102"
    disable_auto_resolve = false

    #[[rules.urumqi_p102_total_livenode_from_pool]]
    #dialect = "athena:rawdata"
    #query = '''select count(distinct(name)) as workers from pbtb_mining_pool_worker where normalized_uri like 'https://api.nanopool.org/v1/eth/user/0x2991728c82587C3E86A3bA47F204F11aB875D22b' and to_unixtime(now()) - _pbtb_ts < 3600 and to_unixtime(now()) - last_share < 3600 and parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    #warning_threshold = 44.0
    #critical_threshold = 42.0
    #service = "urumqi"
    #check_interval = 600
    #counter_threshold = 0.0
    #dc = "urumqi"
    #disable_auto_resolve = true

    # trigger when missing one node. and send to the PD dynamic servcie
    [[rules.urumqi_p102_warning_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('00c60198e81cbba05916463195d69ad7d376e415e3') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 92.0
    critical_threshold = 91.0
    service = "urumqi_dynamic"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_p102"
    disable_auto_resolve = false

    [[rules.urumqi_p102_max_gpu_temperature]]
    dialect = "clickhouse:stats"
    query = '''select max(temperature) from miner_card_stats where site_key=unhex('00c60198e81cbba05916463195d69ad7d376e415e3') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 79.0
    critical_threshold = 85.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_p102"
    disable_auto_resolve = false

    #######  DC Urumqi 1070 #######

    [[rules.urumqi_1070_total_hashrate_eth]]
    dialect = "clickhouse:stats"
    query = '''select sum(hashrate)/1000000 from (select avg(hash_rate) as hashrate from miner_speed where site_key='19EAtxTncfYRwcyVw3reNZmVdXspyfixoR' and time>subtractMinutes(now(),20)  and algorithm=1 group by worker,pci_id)'''
    warning_threshold = 4500.0
    critical_threshold = 4200.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_1070"
    disable_auto_resolve = false

    #[[rules.urumqi_1070_total_hashrate_eth_from_pool]]
    #dialect = "athena:rawdata"
    #query = '''select sum(hashrate)/1000000 from (select avg(hash_rate) as hashrate from pbtb_mining_pool_worker where normalized_uri like 'https://www.sparkpool.com/v1/worker/list?miner=0x3ca1a99Abf377769e9d9A65cE3FAf19034Ca8d13&pool=SPARK_POOL_CN&currency=ETH' and to_unixtime(now()) - _pbtb_ts < 3600 and parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day group by name )'''
    #warning_threshold = 4200.0
    #critical_threshold = 4100.0
    #service = "urumqi"
    #check_interval = 600
    #counter_threshold = 0.0
    #dc = "urumqi_1070"
    #disable_auto_resolve = true

    [[rules.urumqi_1070_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('005a3eaca372534660bb7ddcf0cecce6466b45744c') and time>subtractMinutes(now(), 20)'''
    warning_threshold = 49.0
    critical_threshold = 47.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_1070"
    disable_auto_resolve = false

    #[[rules.urumqi_1070_total_livenode_from_pool]]
    #dialect = "athena:rawdata"
    #query = '''select count(distinct(name)) as workers from pbtb_mining_pool_worker where normalized_uri like 'https://api.nanopool.org/v1/eth/user/0x3ca1a99Abf377769e9d9A65cE3FAf19034Ca8d13' and to_unixtime(now()) - _pbtb_ts < 3600 and to_unixtime(now()) - last_share < 3600 and parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    #warning_threshold = 148.0
    #critical_threshold = 146.0
    #service = "urumqi"
    #check_interval = 600
    #counter_threshold = 0.0
    #dc = "urumqi_1070"
    #disable_auto_resolve = true

    # trigger when missing one node. and send to the PD dynamic servcie
    [[rules.urumqi_1070_warning_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('005a3eaca372534660bb7ddcf0cecce6466b45744c') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 50.0
    critical_threshold = 49.0
    service = "urumqi_dynamic"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_1070"
    disable_auto_resolve = false

    [[rules.urumqi_1070_max_gpu_temperature]]
    dialect = "clickhouse:stats"
    query = '''select max(temperature) from miner_card_stats where site_key=unhex('005a3eaca372534660bb7ddcf0cecce6466b45744c') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 79.0
    critical_threshold = 85.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_1070"
    disable_auto_resolve = false

    #######  DC Urumqi 2060s #######

    [[rules.urumqi_2060s_total_livenode]]
    dialect = "clickhouse:stats"
    query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('00F7A298416ACBA219C449D51878FDC20423CA8396') and time>subtractMinutes(now(), 20)'''
    warning_threshold = 407.0
    critical_threshold = 405.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_2060s"
    disable_auto_resolve = false

    #[[rules.urumqi_2060s_warning_total_livenode]]
    #dialect = "clickhouse:stats"
    #query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('00F7A298416ACBA219C449D51878FDC20423CA8396') and time>subtractMinutes(now(), 10)'''
    #warning_threshold = 407.0
    #critical_threshold = 406.0
    #service = "urumqi_dynamic"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "urumqi_2060s"
    #disable_auto_resolve = false

    [[rules.urumqi_2060s_total_hashrate_cfx]]
    dialect = "clickhouse:stats"
    query = '''select sum(hash_rate)/1000000 from (select avg(hash_rate) as hash_rate from miner_speed  where time>subtractMinutes(now(),20) and site_key='1PaNgfUFPTWPCHhXiLxUv9VADWVWqD3ztt' group by worker, pci_id)'''
    warning_threshold = 104000.0
    critical_threshold = 101000.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_2060s"
    disable_auto_resolve = false


    [[rules.urumqi_2060s_max_gpu_temperature]]
    dialect = "clickhouse:stats"
    query = '''select max(temperature) from miner_card_stats where site_key=unhex('00F7A298416ACBA219C449D51878FDC20423CA8396') and time>subtractMinutes(now(), 10)'''
    warning_threshold = 79.0
    critical_threshold = 85.0
    service = "urumqi"
    check_interval = 120
    counter_threshold = 0.006
    dc = "urumqi_2060s"
    disable_auto_resolve = false

    #######  DC ICN01  #######
    #[[rules.icn01_total_livenode]]
    #dialect = "clickhouse:stats"
    #query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('00de6b6c73376743452cce66efaa1cb94f4bbc107b') and time>subtractMinutes(now(), 10)'''
    #warning_threshold = 240.0
    #critical_threshold = 238.0
    #service = "south_korea"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "icn01"
    #disable_auto_resolve = true

    #[[rules.icn01_warning_total_livenode]]
    #dialect = "clickhouse:stats"
    #query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('00de6b6c73376743452cce66efaa1cb94f4bbc107b') and time>subtractMinutes(now(), 10)'''
    #warning_threshold = 241.0
    #critical_threshold = 240.0
    #service = "south_korea_dynamic"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "icn01"
    #disable_auto_resolve = true

    [[rules.icn01_total_livenode_from_pool]]
    dialect = "clickhouse:stats"
    query = '''select count (distinct worker) from miner_pool_stats where normalized_uri LIKE 'https://www.sparkpool.com/v1/worker/list?miner=0x8488C7fbB70921a3ec35Da4539e63562e4B7a8a5&pool=SPARK_POOL_CN&currency=ETH' and time>subtractMinutes(now(),60) and FROM_UNIXTIME(toInt64(last_share))>subtractMinutes(now(),60)'''
    warning_threshold = 200.0
    critical_threshold = 190.0
    service = "south_korea"
    check_interval = 600
    counter_threshold = 0.0
    dc = "icn01"
    disable_auto_resolve = true

    #[[rules.icn01_total_hashrate_ethash]]
    #dialect = "clickhouse:stats"
    #query = '''select sum(hashrate)/1000000000 from (select avg(hashrate1h) as hashrate from miner_card_algorithm_hashrate_new where site_key=unhex('00de6b6c73376743452cce66efaa1cb94f4bbc107b') and time>subtractMinutes(now(), 10) group by worker,pci_id)'''
    #warning_threshold = 54000.0
    #critical_threshold = 53000.0
    #service = "south_korea"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "icn01"
    #disable_auto_resolve = true

    [[rules.icn01_total_hashrate_ethash_from_pool]]
    dialect = "athena:rawdata"
    query = '''SELECT sum(hashrate) FROM (SELECT avg(hash_rate)/1000000 AS hashrate FROM pbtb_mining_pool_worker WHERE normalized_uri LIKE 'https://www.sparkpool.com/v1/worker/list?miner=0x8488C7fbB70921a3ec35Da4539e63562e4B7a8a5&pool=SPARK_POOL_CN&currency=ETH' AND to_unixtime(now()) - _pbtb_ts < 3600 AND parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day GROUP BY  name )'''
    warning_threshold = 38000.0
    critical_threshold = 36000.0
    service = "south_korea"
    check_interval = 600
    counter_threshold = 0.0
    dc = "icn01"
    disable_auto_resolve = true

    #[[rules.icn01_max_gpu_temperature]]
    #dialect = "clickhouse:stats"
    #query = '''select max(temperature) from miner_card_stats where site_key=unhex('00de6b6c73376743452cce66efaa1cb94f4bbc107b') and time>subtractMinutes(now(), 10)'''
    #warning_threshold = 81.0
    #critical_threshold = 82.0
    #service = "south_korea"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "icn01"
    #disable_auto_resolve = true

    [[rules.icn01_max_syslog_daily_quantity]]
    dialect = "athena:rawdata"
    query = '''SELECT count(_pbtb_uuid) AS count FROM pbtb_syslog WHERE dc='icn01' AND _pbtb_ts > to_unixtime(now()) - 86400 AND parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day '''
    warning_threshold = 20390400.0
    critical_threshold = 24468480.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "icn01"
    disable_auto_resolve = true

    #######  DC KWJ01 #######

    #[[rules.kwj01_total_livenode]]
    #dialect = "clickhouse:stats"
    #query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('00bf0ea4a4139a500817ff05fc5c2fa77a8448f017') and time>subtractMinutes(now(), 10)'''
    #warning_threshold = 184.0
    #critical_threshold = 182.0
    #service = "south_korea"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "kwj01"
    #disable_auto_resolve = true

    #[[rules.kwj01_warning_total_livenode]]
    #dialect = "clickhouse:stats"
    #query = '''select count(distinct(worker)) from miner_card_stats where site_key=unhex('00bf0ea4a4139a500817ff05fc5c2fa77a8448f017') and time>subtractMinutes(now(), 10)'''
    #warning_threshold = 185.0
    #critical_threshold = 184.0
    #service = "south_korea_dynamic"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "kwj01"
    #disable_auto_resolve = true

    [[rules.kwj01_total_livenode_from_pool]]
    dialect = "clickhouse:stats"
    query = '''select count (distinct worker) from miner_pool_stats where normalized_uri LIKE 'https://www.sparkpool.com/v1/worker/list?miner=0x5Bd50347E86412bae3c37998D5E25696eD2ad47B&pool=SPARK_POOL_CN&currency=ETH' and time>subtractMinutes(now(),60) and FROM_UNIXTIME(toInt64(last_share))>subtractMinutes(now(),60)'''
    warning_threshold = 120.0
    critical_threshold = 110.0
    service = "south_korea"
    check_interval = 600
    counter_threshold = 0.0
    dc = "kwj01"
    disable_auto_resolve = true

    #[[rules.kwj01_total_hashrate_ethash]]
    #dialect = "clickhouse:stats"
    #query = '''select sum(hashrate)/1000000000 from (select avg(hashrate1h) as hashrate from miner_card_algorithm_hashrate_new where site_key=unhex('00bf0ea4a4139a500817ff05fc5c2fa77a8448f017') and time>subtractMinutes(now(), 10) group by worker,pci_id)'''
    #warning_threshold = 41000.0
    #critical_threshold = 40000.0
    #service = "south_korea"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "kwj01"
    #disable_auto_resolve = true

    [[rules.kwj01_total_hashrate_ethash_from_pool]]
    dialect = "athena:rawdata"
    query = '''SELECT sum(hashrate) FROM (SELECT avg(hash_rate)/1000000 AS hashrate FROM pbtb_mining_pool_worker WHERE normalized_uri LIKE 'https://www.sparkpool.com/v1/worker/list?miner=0x5Bd50347E86412bae3c37998D5E25696eD2ad47B&pool=SPARK_POOL_CN&currency=ETH' AND to_unixtime(now()) - _pbtb_ts < 3600 AND parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day GROUP BY  name )'''
    warning_threshold = 25000.0
    critical_threshold = 20000.0
    service = "south_korea"
    check_interval = 600
    counter_threshold = 0.0
    dc = "kwj01"
    disable_auto_resolve = true

    #[[rules.kwj01_max_gpu_temperature]]
    #dialect = "clickhouse:stats"
    #query = '''select max(temperature) from miner_card_stats where site_key=unhex('00bf0ea4a4139a500817ff05fc5c2fa77a8448f017') and time>subtractMinutes(now(), 10)'''
    #warning_threshold = 81.0
    #critical_threshold = 82.0
    #service = "south_korea"
    #check_interval = 120
    #counter_threshold = 0.006
    #dc = "kwj01"
    #disable_auto_resolve = true


    [[rules.kwj01_max_syslog_daily_quantity]]
    dialect = "athena:rawdata"
    query = '''SELECT count(_pbtb_uuid) AS count FROM pbtb_syslog WHERE dc='kwj01' AND _pbtb_ts > to_unixtime(now()) - 86400 AND parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day '''
    warning_threshold = 14860800.0
    critical_threshold = 17832960.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "kwj01"
    disable_auto_resolve = true

    #######  ingenstion cronjob #######

    #[[rules.ingestion_influxdb_algorithm]]
    #dialect = "athena:rawdata"
    #query = '''SELECT coalesce(min(to_unixtime(now()) - ts),86402) AS staleness FROM influxdb_algorithm WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    #warning_threshold = 86400.0
    #critical_threshold = 86401.0
    #service = "ops"
    #check_interval = 600
    #counter_threshold = 0.0
    #dc = "yul01"
    #disable_auto_resolve = true

    #[[rules.ingestion_influxdb_machine]]
    #dialect = "athena:rawdata"
    #query = '''SELECT coalesce(min(to_unixtime(now()) - ts),86402) AS staleness FROM influxdb_machine WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    #warning_threshold = 86400.0
    #critical_threshold = 86401.0
    #service = "ops"
    #check_interval = 600
    #counter_threshold = 0.0
    #dc = "yul01"
    #disable_auto_resolve = true

    #[[rules.ingestion_influxdb_miner]]
    #dialect = "athena:rawdata"
    #query = '''SELECT coalesce(min(to_unixtime(now()) - ts),86402) AS staleness FROM influxdb_miner WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    #warning_threshold = 86400.0
    #critical_threshold = 86401.0
    #service = "ops"
    #check_interval = 600
    #counter_threshold = 0.0
    #dc = "yul01"
    #disable_auto_resolve = true

    [[rules.ingestion_influxdb_temperatures]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - ts),86402) AS staleness FROM influxdb_temperatures WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_coin_stats]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_coin_stats WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_etherscan_transaction_events]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),94002) AS staleness FROM pbtb_etherscan_transaction_events WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 94000.0
    critical_threshold = 94001.0
    service = "ops"
    check_interval = 1200
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_market_stats]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_market_stats WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_miner_stats_protobuf]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_miner_stats_protobuf WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_mining_hash_rate]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_mining_hash_rate WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_mining_pool_reward]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),172802) AS staleness FROM pbtb_mining_pool_reward WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 172800.0
    critical_threshold = 172801.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_mining_pool_worker]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_mining_pool_worker WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_pagerduty_logs]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_pagerduty_logs WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_remote_miner_stats_protobuf]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_remote_miner_stats_protobuf WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.yul02_ingestion_pbtb_syslog]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_syslog WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day AND dc='yul02' '''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul02"
    disable_auto_resolve = true

    [[rules.urumqi_ingestion_pbtb_syslog]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_syslog WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day AND dc='urumqi' '''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "urumqi"
    disable_auto_resolve = true

    [[rules.ingestion_pbtb_telemetry_alert]]
    dialect = "athena:rawdata"
    query = '''SELECT coalesce(min(to_unixtime(now()) - _pbtb_ts),86402) AS staleness FROM pbtb_telemetry_alert WHERE parse_datetime(concat(yyyy,'/',mm,'/',dd), 'yyyy/MM/dd') > now() - interval '2' day'''
    warning_threshold = 86400.0
    critical_threshold = 86401.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    # fact table
    [[rules.ingestion_fact_bminer_active_gpu_count]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_active_gpu_count WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_fact_bminer_algorithm_stats]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_algorithm_stats WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_fact_bminer_device_distribution]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_device_distribution WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_fact_bminer_device_info]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_device_info WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true


    [[rules.ingestion_fact_bminer_farm_summary_stats]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_farm_summary_stats WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_fact_bminer_market_share_dash]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_market_share_dash WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_fact_bminer_online_device_distribution]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_online_device_distribution WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_fact_bminer_online_device_info]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_online_device_info WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_fact_bminer_revenue]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_bminer_revenue WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    [[rules.ingestion_fact_miner_profitability]]
    dialect = "athena:dwh"
    query = '''SELECT count(*) FROM fact_miner_profitability WHERE date > current_date - interval '2' day'''
    warning_threshold = 2.0
    critical_threshold = 1.0
    service = "ops"
    check_interval = 600
    counter_threshold = 0.0
    dc = "yul01"
    disable_auto_resolve = true

    ####### shepherd master monitor ######
    [[rules.yul02_shepherd_master_monitor]]
    dialect = "influxdb:monitor"
    query = '''select count(*) from (select mean(status) from monitor where time > now() - 10m and dc='yul02' group by service)'''
    warning_threshold = 8.0
    critical_threshold = 7.0
    service = "ops"
    check_interval = 120
    counter_threshold = 0.1
    dc = "yul02"
    disable_auto_resolve = true

    [[rules.urumqi_shepherd_master_monitor]]
    dialect = "influxdb:monitor"
    query = '''select count(*) from (select mean(status) from monitor where time > now() - 10m and dc='urumqi' group by service)'''
    warning_threshold = 8.0
    critical_threshold = 7.0
    service = "ops"
    check_interval = 120
    counter_threshold = 0.1
    dc = "urumqi"
    disable_auto_resolve = true

    [[rules.icn01_shepherd_master_monitor]]
    dialect = "influxdb:monitor"
    query = '''select count(*) from (select mean(status) from monitor where time > now() - 10m and dc='icn01' group by service)'''
    warning_threshold = 8.0
    critical_threshold = 7.0
    service = "ops"
    check_interval = 120
    counter_threshold = 0.1
    dc = "icn01"
    disable_auto_resolve = true


    [[rules.kwj01_shepherd_master_monitor]]
    dialect = "influxdb:monitor"
    query = '''select count(*) from (select mean(status) from monitor where time > now() - 10m and dc='kwj01' group by service)'''
    warning_threshold = 8.0
    critical_threshold = 7.0
    service = "ops"
    check_interval = 120
    counter_threshold = 0.1
    dc = "kwj01"
    disable_auto_resolve = true

    # progpow
    [[rules.progpow_raven_insufficicent]]
    dialect = "progpow:raven"
    query = '''select remain from progpow where algorithm="raven"'''
    # block time is 1 min. threshold value = 7 days * (24 hours * 60 min ) / 1 min
    warning_threshold = 10081.0
    critical_threshold = 10080.0
    service = "bminer"
    check_interval = 120
    counter_threshold = 0.1
    dc = "all"
    disable_auto_resolve = true

    [[rules.progpow_sero_insufficicent]]
    dialect = "progpow:sero"
    query = 'select remain from progpow where algorithm="sero"'
    # block time is 13.32s. threshold value = 7 days * (24 hours * 60 min * 60s ) / 13.32s
    warning_threshold = 45406.0
    critical_threshold = 45405.0
    service = "bminer"
    check_interval = 120
    counter_threshold = 0.1
    dc = "all"
    disable_auto_resolve = true

    [services]

    [[services.yul01]]
    description = "DC operation in YUL01"
    route = "pagerduty"
    pagerduty_key = "338d3d0b342b46d38ce8c90d314a5608"

    [[services.ops]]
    description = "system operator"
    route = "pagerduty"
    pagerduty_key = "49787e8c1d284022a40e4beff4e58b30"

    [[services.yul02]]
    description = "DC operation in YUL02"
    route = "pagerduty"
    pagerduty_key = "9f89f001e491438eb29dc0d693dd1cf3"

    [[services.yul_dynamic]]
    description = "Dynamic Notification in YUL"
    route = "pagerduty"
    pagerduty_key = "947e6cebcf1c43bda58f4c6ffd38e8a9"

    [[services.urumqi]]
    description = "DC operation in Urumqi"
    route = "pagerduty"
    pagerduty_key = "bc4d0ced80c34cac82f4611d5727bee4"

    [[services.urumqi_dynamic]]
    description = "Dynamic Notification in Urumqi"
    route = "pagerduty"
    pagerduty_key = "2ff215a91ac14656a2848d1aeb01eec5"

    [[services.south_korea]]
    description = "DC operation in South Korea"
    route = "pagerduty"
    pagerduty_key = "bf6e10f717fc43209310ad71ed85d7c5"

    [[services.south_korea_dynamic]]
    description = "Dynamic Notification in South Korea"
    route = "pagerduty"
    pagerduty_key = "8d701602d315439eb060bafc04e0950d"

    [[services.pool]]
    description = "pool alert"
    route = "pagerduty"
    pagerduty_key = "0876a5b40b7c4089962b39333bc98cb2"

    [[services.bminer]]
    description = "bminer dev group"
    route = "pagerduty"
    pagerduty_key = "f55338227edf47ecb246a9c4fd77efab"

    [alerters]

    [datasources]

    [[datasources.influxdb]]

    [[datasources.influxdb.farm]]
    endpoint="http://influxdb.default:8086"
    db="farm"
    [[datasources.influxdb.pool]]
    endpoint="http://influxdb.default:8086"
    db="pool"
    [[datasources.influxdb.monitor]]
    endpoint="http://influxdb.default:8086"
    db="monitor"

    [[datasources.athena]]
    [[datasources.athena.rawdata]]
    db="rawdata"
    region="us-west-2"

    [[datasources.athena]]
    [[datasources.athena.dwh]]
    db="dwh"
    region="us-west-2"

    [[datasources.clickhouse]]
    [[datasources.clickhouse.stats]]
    endpoint="clickhouse-miner-stats.data.svc.cluster.local:9000"
    db="miner_stats"

    [[datasources.clickhouse]]
    [[datasources.clickhouse.pool]]
    endpoint="clickhouse-miner-stats.data.svc.cluster.local:9000"
    db="conflux_pool"

    [[datasources.progpow]]
    [datasources.progpow.raven]
    bucket = "www.bminercontent.com"
    region="us-west-2"
    key_prefix="kernels/progpow/raven"
    [datasources.progpow.sero]
    bucket = "www.bminercontent.com"
    region="us-west-2"
    key_prefix="kernels/progpow/sero"

