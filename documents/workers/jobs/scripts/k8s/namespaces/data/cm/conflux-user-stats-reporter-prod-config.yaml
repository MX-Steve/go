apiVersion: v1
data:
  conflux-pool-hashrate-15m-reporter-prod.config: |-
    {
      "topic_name": "pool_share_v2",
      "bootstrap_servers": "kafka.kafka:9092",
      "checkpoint_table": "conflux-pool-15m-hashrate-checkpoint",
      "window_size": 900,
      "sql_template": "SELECT (CAST(submitted / 900 AS INT) + 1) * 900 AS ts, CAST(SUM(18446744073709551616.0 / 900.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\"ACCEPTED_SHARE\" AND CAST(submitted / 900 AS INT) >= CAST(%s / 900 AS INT) AND CAST(submitted / 900 AS INT) < CAST(%s / 900 AS INT) GROUP BY CAST(submitted / 900 AS INT)",
      "jdbc_driver_class_name": "ru.yandex.clickhouse.ClickHouseDriver",
      "jdbc_url": "jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer&password=2WHvybnS5vHsrMJ2",
      "jdbc_sink_sql": "INSERT INTO conflux_pool_hashrate_15m VALUES(?, ?)"
    }
  conflux-pool-hashrate-24h-reporter-prod.config: |-
    {
      "topic_name": "pool_share_v2",
      "bootstrap_servers": "kafka.kafka:9092",
      "checkpoint_table": "conflux-pool-24h-hashrate-checkpoint",
      "window_size": 86400,
      "sql_template": "SELECT (CAST(submitted / 86400 AS INT) + 1) * 86400 AS ts, CAST(SUM(18446744073709551616.0 / 86400.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\"ACCEPTED_SHARE\" AND CAST(submitted / 86400 AS INT) >= CAST(%s / 86400 AS INT) AND CAST(submitted / 86400 AS INT) < CAST(%s / 86400 AS INT) GROUP BY CAST(submitted / 86400 AS INT)",
      "jdbc_driver_class_name": "ru.yandex.clickhouse.ClickHouseDriver",
      "jdbc_url": "jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer&password=2WHvybnS5vHsrMJ2",
      "jdbc_sink_sql": "INSERT INTO conflux_pool_hashrate_24h VALUES(?, ?)"
    }
  conflux-user-hashrate-15m-reporter-prod.config: |-
    {
      "topic_name": "pool_share_v2",
      "bootstrap_servers": "kafka.kafka:9092",
      "checkpoint_table": "conflux-user-15m-hashrate-checkpoint",
      "window_size": 900,
      "sql_template": "SELECT (CAST(submitted / 900 AS INT) + 1) * 900 AS ts, username, CAST(SUM(18446744073709551616.0 / 900.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\"ACCEPTED_SHARE\" AND CAST(submitted / 900 AS INT) >= CAST(%s / 900 AS INT) AND CAST(submitted / 900 AS INT) < CAST(%s / 900 AS INT) GROUP BY username, CAST(submitted / 900 AS INT)",
      "jdbc_driver_class_name": "ru.yandex.clickhouse.ClickHouseDriver",
      "jdbc_url": "jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer&password=2WHvybnS5vHsrMJ2",
      "jdbc_sink_sql": "INSERT INTO conflux_user_hashrate_15m VALUES(?, ?, ?)"
    }
  conflux-user-hashrate-24h-reporter-prod.config: |-
    {
      "topic_name": "pool_share_v2",
      "bootstrap_servers": "kafka.kafka:9092",
      "checkpoint_table": "conflux-user-24h-hashrate-checkpoint",
      "window_size": 86400,
      "sql_template": "SELECT (CAST(submitted / 86400 AS INT) + 1) * 86400 AS ts, username, CAST(SUM(18446744073709551616.0 / 86400.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\"ACCEPTED_SHARE\" AND CAST(submitted / 86400 AS INT) >= CAST(%s / 86400 AS INT) AND CAST(submitted / 86400 AS INT) < CAST(%s / 86400 AS INT) GROUP BY username, CAST(submitted / 86400 AS INT)",
      "jdbc_driver_class_name": "ru.yandex.clickhouse.ClickHouseDriver",
      "jdbc_url": "jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer&password=2WHvybnS5vHsrMJ2",
      "jdbc_sink_sql": "INSERT INTO conflux_user_hashrate_24h VALUES(?, ?, ?)"
    }
  conflux-user-worker-hashrate-15m-reporter-prod.config: |-
    {
      "topic_name": "pool_share_v2",
      "bootstrap_servers": "kafka.kafka:9092",
      "checkpoint_table": "conflux-user-worker-15m-hashrate-checkpoint",
      "window_size": 900,
      "sql_template": "SELECT (CAST(submitted / 900 AS INT) + 1) * 900 AS ts, username, worker, CAST(SUM(18446744073709551616.0 / 900.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\"ACCEPTED_SHARE\" AND CAST(submitted / 900 AS INT) >= CAST(%s / 900 AS INT) AND CAST(submitted / 900 AS INT) < CAST(%s / 900 AS INT) GROUP BY username, worker, CAST(submitted / 900 AS INT)",
      "jdbc_driver_class_name": "ru.yandex.clickhouse.ClickHouseDriver",
      "jdbc_url": "jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer&password=2WHvybnS5vHsrMJ2",
      "jdbc_sink_sql": "INSERT INTO conflux_user_worker_hashrate_15m VALUES(?, ?, ?, ?)"
    }
  conflux-user-worker-hashrate-24h-reporter-prod.config: |-
    {
      "topic_name": "pool_share_v2",
      "bootstrap_servers": "kafka.kafka:9092",
      "checkpoint_table": "conflux-user-worker-24h-hashrate-checkpoint",
      "window_size": 86400,
      "sql_template": "SELECT (CAST(submitted / 86400 AS INT) + 1) * 86400 AS ts, username, worker, CAST(SUM(18446744073709551616.0 / 86400.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\"ACCEPTED_SHARE\" AND CAST(submitted / 86400 AS INT) >= CAST(%s / 86400 AS INT) AND CAST(submitted / 86400 AS INT) < CAST(%s / 86400 AS INT) GROUP BY username, worker, CAST(submitted / 86400 AS INT)",
      "jdbc_driver_class_name": "ru.yandex.clickhouse.ClickHouseDriver",
      "jdbc_url": "jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer&password=2WHvybnS5vHsrMJ2",
      "jdbc_sink_sql": "INSERT INTO conflux_user_worker_hashrate_24h VALUES(?, ?, ?, ?)"
    }
kind: ConfigMap
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","data":{"conflux-pool-hashrate-15m-reporter-prod.config":"{\n  \"topic_name\": \"pool_share_v2\",\n  \"bootstrap_servers\": \"kafka.kafka:9092\",\n  \"checkpoint_table\": \"conflux-pool-15m-hashrate-checkpoint\",\n  \"window_size\": 900,\n  \"sql_template\": \"SELECT (CAST(submitted / 900 AS INT) + 1) * 900 AS ts, CAST(SUM(18446744073709551616.0 / 900.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\\\"ACCEPTED_SHARE\\\" AND CAST(submitted / 900 AS INT) \u003e= CAST(%s / 900 AS INT) AND CAST(submitted / 900 AS INT) \u003c CAST(%s / 900 AS INT) GROUP BY CAST(submitted / 900 AS INT)\",\n  \"jdbc_driver_class_name\": \"ru.yandex.clickhouse.ClickHouseDriver\",\n  \"jdbc_url\": \"jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer\u0026password=2WHvybnS5vHsrMJ2\",\n  \"jdbc_sink_sql\": \"INSERT INTO conflux_pool_hashrate_15m VALUES(?, ?)\"\n}","conflux-pool-hashrate-24h-reporter-prod.config":"{\n  \"topic_name\": \"pool_share_v2\",\n  \"bootstrap_servers\": \"kafka.kafka:9092\",\n  \"checkpoint_table\": \"conflux-pool-24h-hashrate-checkpoint\",\n  \"window_size\": 86400,\n  \"sql_template\": \"SELECT (CAST(submitted / 86400 AS INT) + 1) * 86400 AS ts, CAST(SUM(18446744073709551616.0 / 86400.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\\\"ACCEPTED_SHARE\\\" AND CAST(submitted / 86400 AS INT) \u003e= CAST(%s / 86400 AS INT) AND CAST(submitted / 86400 AS INT) \u003c CAST(%s / 86400 AS INT) GROUP BY CAST(submitted / 86400 AS INT)\",\n  \"jdbc_driver_class_name\": \"ru.yandex.clickhouse.ClickHouseDriver\",\n  \"jdbc_url\": \"jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer\u0026password=2WHvybnS5vHsrMJ2\",\n  \"jdbc_sink_sql\": \"INSERT INTO conflux_pool_hashrate_24h VALUES(?, ?)\"\n}","conflux-user-hashrate-15m-reporter-prod.config":"{\n  \"topic_name\": \"pool_share_v2\",\n  \"bootstrap_servers\": \"kafka.kafka:9092\",\n  \"checkpoint_table\": \"conflux-user-15m-hashrate-checkpoint\",\n  \"window_size\": 900,\n  \"sql_template\": \"SELECT (CAST(submitted / 900 AS INT) + 1) * 900 AS ts, username, CAST(SUM(18446744073709551616.0 / 900.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\\\"ACCEPTED_SHARE\\\" AND CAST(submitted / 900 AS INT) \u003e= CAST(%s / 900 AS INT) AND CAST(submitted / 900 AS INT) \u003c CAST(%s / 900 AS INT) GROUP BY username, CAST(submitted / 900 AS INT)\",\n  \"jdbc_driver_class_name\": \"ru.yandex.clickhouse.ClickHouseDriver\",\n  \"jdbc_url\": \"jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer\u0026password=2WHvybnS5vHsrMJ2\",\n  \"jdbc_sink_sql\": \"INSERT INTO conflux_user_hashrate_15m VALUES(?, ?, ?)\"\n}","conflux-user-hashrate-24h-reporter-prod.config":"{\n  \"topic_name\": \"pool_share_v2\",\n  \"bootstrap_servers\": \"kafka.kafka:9092\",\n  \"checkpoint_table\": \"conflux-user-24h-hashrate-checkpoint\",\n  \"window_size\": 86400,\n  \"sql_template\": \"SELECT (CAST(submitted / 86400 AS INT) + 1) * 86400 AS ts, username, CAST(SUM(18446744073709551616.0 / 86400.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\\\"ACCEPTED_SHARE\\\" AND CAST(submitted / 86400 AS INT) \u003e= CAST(%s / 86400 AS INT) AND CAST(submitted / 86400 AS INT) \u003c CAST(%s / 86400 AS INT) GROUP BY username, CAST(submitted / 86400 AS INT)\",\n  \"jdbc_driver_class_name\": \"ru.yandex.clickhouse.ClickHouseDriver\",\n  \"jdbc_url\": \"jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer\u0026password=2WHvybnS5vHsrMJ2\",\n  \"jdbc_sink_sql\": \"INSERT INTO conflux_user_hashrate_24h VALUES(?, ?, ?)\"\n}","conflux-user-worker-hashrate-15m-reporter-prod.config":"{\n  \"topic_name\": \"pool_share_v2\",\n  \"bootstrap_servers\": \"kafka.kafka:9092\",\n  \"checkpoint_table\": \"conflux-user-worker-15m-hashrate-checkpoint\",\n  \"window_size\": 900,\n  \"sql_template\": \"SELECT (CAST(submitted / 900 AS INT) + 1) * 900 AS ts, username, worker, CAST(SUM(18446744073709551616.0 / 900.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\\\"ACCEPTED_SHARE\\\" AND CAST(submitted / 900 AS INT) \u003e= CAST(%s / 900 AS INT) AND CAST(submitted / 900 AS INT) \u003c CAST(%s / 900 AS INT) GROUP BY username, worker, CAST(submitted / 900 AS INT)\",\n  \"jdbc_driver_class_name\": \"ru.yandex.clickhouse.ClickHouseDriver\",\n  \"jdbc_url\": \"jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer\u0026password=2WHvybnS5vHsrMJ2\",\n  \"jdbc_sink_sql\": \"INSERT INTO conflux_user_worker_hashrate_15m VALUES(?, ?, ?, ?)\"\n}","conflux-user-worker-hashrate-24h-reporter-prod.config":"{\n  \"topic_name\": \"pool_share_v2\",\n  \"bootstrap_servers\": \"kafka.kafka:9092\",\n  \"checkpoint_table\": \"conflux-user-worker-24h-hashrate-checkpoint\",\n  \"window_size\": 86400,\n  \"sql_template\": \"SELECT (CAST(submitted / 86400 AS INT) + 1) * 86400 AS ts, username, worker, CAST(SUM(18446744073709551616.0 / 86400.0 / pow_solution_conflux.target) AS BIGINT) AS hashrate FROM conflux_pool_share WHERE status=\\\"ACCEPTED_SHARE\\\" AND CAST(submitted / 86400 AS INT) \u003e= CAST(%s / 86400 AS INT) AND CAST(submitted / 86400 AS INT) \u003c CAST(%s / 86400 AS INT) GROUP BY username, worker, CAST(submitted / 86400 AS INT)\",\n  \"jdbc_driver_class_name\": \"ru.yandex.clickhouse.ClickHouseDriver\",\n  \"jdbc_url\": \"jdbc:clickhouse://clickhouse-miner-stats.data:8123/conflux_pool?user=bminer\u0026password=2WHvybnS5vHsrMJ2\",\n  \"jdbc_sink_sql\": \"INSERT INTO conflux_user_worker_hashrate_24h VALUES(?, ?, ?, ?)\"\n}"},"kind":"ConfigMap","metadata":{"annotations":{},"name":"conflux-user-stats-reporter-prod-config","namespace":"data"}}
  creationTimestamp: "2020-10-31T22:28:13Z"
  name: conflux-user-stats-reporter-prod-config
  namespace: data
  resourceVersion: "125139820"
  selfLink: /api/v1/namespaces/data/configmaps/conflux-user-stats-reporter-prod-config
  uid: fc759b3e-7c0e-4cb1-97ba-252cd5bdd3cb
