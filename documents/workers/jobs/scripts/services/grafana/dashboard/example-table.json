{
    "cacheTimeout": null,
    "datasource": "clickhouse-miner-stats",
    "description": "calculated by miner data points",
    "fieldConfig": {
      "defaults": {
        "custom": {
          "align": "center",
          "filterable": false
        },
        "thresholds": {
          "mode": "absolute",
          "steps": [
            {
              "color": "dark-red",
              "value": null
            }
          ]
        },
        "mappings": [
          {
            "id": 0,
            "op": "=",
            "text": "N/A",
            "type": 1,
            "value": "null"
          }
        ],
        "unit": "none"
      },
      "overrides": [
        {
          "matcher": {
            "id": "byName",
            "options": "total_rate"
          },
          "properties": [
            {
              "id": "custom.width",
              "value": 162
            }
          ]
        }
      ]
    },
    "gridPos": {
      "h": 11,
      "w": 21,
      "x": 0,
      "y": 0
    },
    "id": 4,
    "interval": "",
    "links": [],
    "maxDataPoints": 100,
    "options": {
      "showHeader": true,
      "sortBy": [
        {
          "desc": true,
          "displayName": "Site"
        }
      ]
    },
    "pluginVersion": "7.5.2",
    "targets": [
      {
        "database": "miner_stats",
        "datasource": "clickhouse-miner-stats",
        "dateColDataType": "time",
        "dateLoading": false,
        "dateTimeColDataType": "time",
        "dateTimeType": "DATETIME",
        "datetimeLoading": false,
        "extrapolate": true,
        "format": "table",
        "formattedQuery": "SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t",
        "hide": true,
        "interval": "",
        "intervalFactor": 1,
        "query": "\nSELECT   multiIf( \n    t1.site_key = '1AgfHaZwJ7YqhBHibukCukjkjafjCb8bax', 'yul01', \n    t1.site_key = '1CCH7ahHUatLuiYdDEbn5n9RwZxNoD6D1n', 'yul02', \n    t1.site_key = '39C4rnYN4FpSE6tcnB7iaWGU3niDJGwvwn', 'yul02_amd', \n    t1.site_key = '18C6UKAprzSbR6R2FMFxpnak991cgjjuDb', 'urc01_p104', \n    t1.site_key = '1K3xhxvZvKaj7EG4NAfw7rY65ghA4r1Qqr', 'urc01_p102', \n    t1.site_key = '19EAtxTncfYRwcyVw3reNZmVdXspyfixoR', 'urc01_1070', \n    t1.site_key = '1PaNgfUFPTWPCHhXiLxUv9VADWVWqD3ztt', 'urc01_2060s', \n    t1.site_key = '1MH3hWen4ftgG7H3YrryMVR4oGzS1vquCB', 'icn01', \n    t1.site_key = '1JRDc4beMDCjjce1S6Xg8ubn5DN84fQNHw', 'kwj01', \n    t1.site_key = '1GnyNrDxA8bKDBDZQhpRhWsr8LPp52s1YK', 'nkg01', \n    t1.site_key) as Site,\n    t1.Live_Nodes, \n    t2.Algorithm,\n    t1.Total_Cards, \n    t2.Total_Hashrate, \n    t1.Max_Temperature,\n    t1.Min_Temperature\nFROM     ( \n    SELECT\n        site_key,\n        count(distinct worker) as Live_Nodes,\n        count(distinct worker,pci_id) as Total_Cards,\n        max(temperature)  as Max_Temperature,\n        min(temperature) as Min_Temperature\n    FROM miner_stats.miner_temperature\n    WHERE $timeFilter\n    and temperature >0 \n    GROUP BY site_key\n    ) as t1 JOIN (\n        SELECT \n            site_key,\n            algorithm as Algorithm, \n            sum(hash_rate)  as Total_Hashrate\n        FROM (\n            select \n                site_key,\n                algorithm,\n                avg(hash_rate) as hash_rate \n            from miner_stats.miner_speed \n        WHERE $timeFilter\n        \n        group by \n            site_key,\n            worker,pci_id,\n            algorithm) \n    group by \n        site_key,\n        algorithm) as t2\n    ON t1.site_key=t2.site_key\n",
        "rawQuery": "SELECT   multiIf(      t1.site_key = '1AgfHaZwJ7YqhBHibukCukjkjafjCb8bax', 'yul01',      t1.site_key = '1CCH7ahHUatLuiYdDEbn5n9RwZxNoD6D1n', 'yul02',      t1.site_key = '39C4rnYN4FpSE6tcnB7iaWGU3niDJGwvwn', 'yul02_amd',      t1.site_key = '18C6UKAprzSbR6R2FMFxpnak991cgjjuDb', 'urc01_p104',      t1.site_key = '1K3xhxvZvKaj7EG4NAfw7rY65ghA4r1Qqr', 'urc01_p102',      t1.site_key = '19EAtxTncfYRwcyVw3reNZmVdXspyfixoR', 'urc01_1070',      t1.site_key = '1PaNgfUFPTWPCHhXiLxUv9VADWVWqD3ztt', 'urc01_2060s',      t1.site_key = '1MH3hWen4ftgG7H3YrryMVR4oGzS1vquCB', 'icn01',      t1.site_key = '1JRDc4beMDCjjce1S6Xg8ubn5DN84fQNHw', 'kwj01',      t1.site_key = '1GnyNrDxA8bKDBDZQhpRhWsr8LPp52s1YK', 'nkg01',      t1.site_key) as Site,     t1.Live_Nodes,      t2.Algorithm,     t1.Total_Cards,      t2.Total_Hashrate,      t1.Max_Temperature,     t1.Min_Temperature FROM     (      SELECT         site_key,         count(distinct worker) as Live_Nodes,         count(distinct worker,pci_id) as Total_Cards,         max(temperature)  as Max_Temperature,         min(temperature) as Min_Temperature     FROM miner_stats.miner_temperature     WHERE time >= toDate(1606376702) AND time >= toDateTime(1606376702)     and temperature >0      GROUP BY site_key     ) as t1 JOIN (         SELECT              site_key,             algorithm as Algorithm,              sum(hash_rate)  as Total_Hashrate         FROM (             select                  site_key,                 algorithm,                 avg(hash_rate) as hash_rate              from miner_stats.miner_speed          WHERE time >= toDate(1606376702) AND time >= toDateTime(1606376702)                  group by              site_key,             worker,pci_id,             algorithm)      group by          site_key,         algorithm) as t2     ON t1.site_key=t2.site_key",
        "refId": "A",
        "round": "0s",
        "table": "miner_speed",
        "tableLoading": false
      },
      {
        "database": "miner_stats",
        "datasource": "clickhouse-miner-stats",
        "dateTimeType": "DATETIME",
        "extrapolate": true,
        "format": "time_series",
        "formattedQuery": "SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t",
        "hide": false,
        "intervalFactor": 1,
        "query": "SELECT   multiIf( \r\n    t1.site_key = '1AgfHaZwJ7YqhBHibukCukjkjafjCb8bax', 'yul01', \r\n    t1.site_key = '1CCH7ahHUatLuiYdDEbn5n9RwZxNoD6D1n', 'yul02', \r\n    t1.site_key = '39C4rnYN4FpSE6tcnB7iaWGU3niDJGwvwn', 'yul02_amd', \r\n    t1.site_key = '18C6UKAprzSbR6R2FMFxpnak991cgjjuDb', 'urc01_p104', \r\n    t1.site_key = '1K3xhxvZvKaj7EG4NAfw7rY65ghA4r1Qqr', 'urc01_p102', \r\n    t1.site_key = '19EAtxTncfYRwcyVw3reNZmVdXspyfixoR', 'urc01_1070', \r\n    t1.site_key = '1PaNgfUFPTWPCHhXiLxUv9VADWVWqD3ztt', 'urc01_2060', \r\n    t1.site_key = '1MH3hWen4ftgG7H3YrryMVR4oGzS1vquCB', 'icn01', \r\n    t1.site_key = '1JRDc4beMDCjjce1S6Xg8ubn5DN84fQNHw', 'kwj01', \r\n    t1.site_key = '1GnyNrDxA8bKDBDZQhpRhWsr8LPp52s1YK', 'nkg01', \r\n    t1.site_key) as Site,\r\n    t1.Live_Nodes,\r\n    t2.Algorithm,\r\n    t1.Total_Live_Cards,\r\n    concat(toString(floor((t1.Total_Live_Cards/t1.total_cards)*100,2)),'%') as online_rate,\r\n    t2.Total_Hashrate,\r\n    t1.Max_Temperature\r\nFROM     ( \r\n   SELECT a.site_key as site_key,algorithm,Live_Nodes,Total_Live_Cards,Max_Temperature,total_cards From(\r\nSELECT site_key,algorithm, \r\n    count(distinct worker) as Live_Nodes,\r\n    count(distinct worker,pci_id) as Total_Live_Cards\r\n    FROM miner_stats.miner_speed\r\n    WHERE time>subtractMinutes(now(),5)\r\n    GROUP BY site_key,algorithm\r\n) as a Join (select site_key,total_cards from grafana_total_cards) as c on a.site_key=c.site_key\r\nJoin (\r\n    SELECT\r\n        site_key,\r\n        max(temperature)  as Max_Temperature\r\n    FROM miner_stats.miner_temperature\r\n    WHERE time>subtractMinutes(now(),5)\r\n    and temperature >0 \r\n    GROUP BY site_key\r\n) as b on a.site_key=b.site_key\r\n    ) as t1 JOIN (\r\n        SELECT \r\n            site_key,\r\n            algorithm as Algorithm, \r\n            concat(toString(floor((sum(hash_rate)/1000000),2)),'Mh/s') as Total_Hashrate\r\n        FROM (\r\n            select \r\n                site_key,\r\n                algorithm,\r\n                avg(hash_rate) as hash_rate \r\n            from miner_stats.miner_speed \r\n        WHERE time>subtractMinutes(now(),5)\r\n        \r\n        group by \r\n            site_key,\r\n            worker,pci_id,\r\n            algorithm) \r\n    group by \r\n        site_key,\r\n        algorithm) as t2\r\n    ON t1.site_key=t2.site_key and t1.algorithm=t2.Algorithm",
        "rawQuery": "SELECT   multiIf(      t1.site_key = '1AgfHaZwJ7YqhBHibukCukjkjafjCb8bax', 'yul01',      t1.site_key = '1CCH7ahHUatLuiYdDEbn5n9RwZxNoD6D1n', 'yul02',      t1.site_key = '39C4rnYN4FpSE6tcnB7iaWGU3niDJGwvwn', 'yul02_amd',      t1.site_key = '18C6UKAprzSbR6R2FMFxpnak991cgjjuDb', 'urc01_p104',      t1.site_key = '1K3xhxvZvKaj7EG4NAfw7rY65ghA4r1Qqr', 'urc01_p102',      t1.site_key = '19EAtxTncfYRwcyVw3reNZmVdXspyfixoR', 'urc01_1070',      t1.site_key = '1PaNgfUFPTWPCHhXiLxUv9VADWVWqD3ztt', 'urc01_2060',      t1.site_key = '1MH3hWen4ftgG7H3YrryMVR4oGzS1vquCB', 'icn01',      t1.site_key = '1JRDc4beMDCjjce1S6Xg8ubn5DN84fQNHw', 'kwj01',      t1.site_key = '1GnyNrDxA8bKDBDZQhpRhWsr8LPp52s1YK', 'nkg01',      t1.site_key) as Site,     t1.Live_Nodes,     t2.Algorithm,     t1.Total_Live_Cards,     concat(toString(floor((t1.Total_Live_Cards/t1.total_cards)*100,2)),'%') as online_rate,     t2.Total_Hashrate,     t1.Max_Temperature FROM     (     SELECT a.site_key as site_key,algorithm,Live_Nodes,Total_Live_Cards,Max_Temperature,total_cards From( SELECT site_key,algorithm,      count(distinct worker) as Live_Nodes,     count(distinct worker,pci_id) as Total_Live_Cards     FROM miner_stats.miner_speed     WHERE time>subtractMinutes(now(),5)     GROUP BY site_key,algorithm ) as a Join (select site_key,total_cards from grafana_total_cards) as c on a.site_key=c.site_key Join (     SELECT         site_key,         max(temperature)  as Max_Temperature     FROM miner_stats.miner_temperature     WHERE time>subtractMinutes(now(),5)     and temperature >0      GROUP BY site_key ) as b on a.site_key=b.site_key     ) as t1 JOIN (         SELECT              site_key,             algorithm as Algorithm,              concat(toString(floor((sum(hash_rate)/1000000),2)),'Mh/s') as Total_Hashrate         FROM (             select                  site_key,                 algorithm,                 avg(hash_rate) as hash_rate              from miner_stats.miner_speed          WHERE time>subtractMinutes(now(),5)                  group by              site_key,             worker,pci_id,             algorithm)      group by          site_key,         algorithm) as t2     ON t1.site_key=t2.site_key and t1.algorithm=t2.Algorithm",
        "refId": "B",
        "round": "0s"
      },
      {
        "database": "miner_stats",
        "datasource": "clickhouse-miner-stats",
        "dateTimeType": "DATETIME",
        "extrapolate": true,
        "format": "time_series",
        "formattedQuery": "SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t",
        "hide": true,
        "intervalFactor": 1,
        "query": "select total_cards from miner_stats.grafana_total_cards",
        "rawQuery": "select total_cards from miner_stats.grafana_total_cards",
        "refId": "C",
        "round": "0s"
      }
    ],
    "timeFrom": null,
    "timeShift": null,
    "title": "Farm Summary",
    "transparent": true,
    "type": "table"
  }